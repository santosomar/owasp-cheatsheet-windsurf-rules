---
trigger: glob
globs: [md, txt, yaml, yml, conf, json, xml]
---


name: Vulnerability Disclosure Best Practices
msg: Follow OWASP Vulnerability Disclosure Cheat Sheet recommendations to establish a secure, clear, and collaborative vulnerability disclosure process.

  Ensure your project or organization provides clear vulnerability reporting channels, adopts coordinated responsible disclosure, and publishes security advisories to strengthen software security and community trust.

tags: [security, process, vulnerability-disclosure, OWASP]

patterns:
  - pattern-either:
      - pattern: 'security@'
      - pattern: '/\.well-known/security\.txt'
      - pattern-inside: |
          "bug bounty"
          "vulnerability disclosure"
          "safe harbor"
          "reporting guidelines"
      - pattern-inside: |
          "response timeline"
          "coordination"
          "disclosure"
          "legal safe harbor"
          "scope"

check: |
  /*
  This rule flags files containing vulnerability disclosure policy and reporting info or references to such concepts.
  While automated detection is limited, ensure these elements are included and updated consistently:
   - Clear, discoverable reporting channels (security@ email, security.txt)
   - Published scope, guidelines, and safe harbor terms
   - Commitment to timely and respectful communication
   - Defined bug bounty program rules if applicable
   - Post-resolution advisories and researcher recognition
  */

  function checkDisclosureArtifacts(text) {
    const lc = text.toLowerCase();
    const hasContact = lc.includes('security@') || lc.includes('.well-known/security.txt');
    const hasGuidelines = /scope|response timeline|safe harbor|report|bounty|coordination|disclosure/.test(lc);
    return hasContact && hasGuidelines;
  }

  return checkDisclosureArtifacts(text);
fix: |
  # Actionable Security Advice

  - üì¢ **Establish Clear Channels:** Provide dedicated, easy-to-find contacts (e.g., security@yourdomain.com, a /.well-known/security.txt file) to receive vulnerability reports.

  - üìã **Publish Reporting Guidelines:** Define and make publicly accessible the scope of assets in-scope, types of vulnerabilities accepted, disclosure process steps, response timelines, and safe harbor policies.

  - ü§ù **Implement Responsible Disclosure:** Encourage private, coordinated disclosure where researchers report issues confidentially before public release. Maintain open, timely, and professional communication.

  - üéØ **Define Bug Bounty Rules (if applicable):** Clearly specify rules, eligible assets, legal protections, and reward criteria. Allocate internal resources to manage submissions effectively.

  - ‚è∞ **Respond Promptly and Transparently:** Acknowledge reports quickly, give clear triage timelines, and provide updates throughout remediation without hostility or threats.

  - üõ† **Verify and Patch with Evidence:** Accept detailed reports with PoCs or logs, respect privacy by redacting sensitive data, and collaborate on verification when possible.

  - üì¢ **Publish Security Advisories:** After fixes, publish easy-to-access advisories including impact, versions affected/fixed, mitigation steps, CVEs, timeline, and credit researchers.

  - ‚öñÔ∏è **Manage Disclosure Timing:** Work with researchers on coordinated public disclosure to balance transparency and user safety, and clearly communicate policies regarding public sharing.

  - üéÅ **Reward Contributions:** Offer monetary or non-monetary rewards (e.g., swag, recognition) to encourage ongoing responsible reporting.

  - üßë‚Äç‚öñÔ∏è **Respect Legal & Ethical Boundaries:** Draft safe harbor policies with legal counsel, avoid legal threats against good-faith reporters, and adhere to applicable testing laws.

  - üßò **Handle Difficult Cases Constructively:** If research interactions become strained, focus on security culture improvements rather than conflict escalation.

  Implementing these practices fosters a security-focused, collaborative environment that improves software resilience and community trust.
```